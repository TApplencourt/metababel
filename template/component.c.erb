#include <babeltrace2/babeltrace.h>
#include <metababel/btx_component.h>
// stdio needed because `params_definition` contain fprintf
#include <stdio.h>

void btx_populate_params(common_data_t *common_data) {
  const bt_value *params = common_data->params;
  btx_params_t *usr_params = common_data->btx_params;
  (void)params;
  (void)usr_params;
  <%= params_definition %>
}

<% static_callback_types.each do |e| %>

void btx_register_callbacks_<%= e.name_sanitized %>(
    void *btx_handle, <%= e.name_sanitized %>_static_callback_f *callback) {
  ((common_data_t *)btx_handle)->static_callbacks-><%= e.name_sanitized %> =
      callback;
}

void btx_call_callbacks_<%= e.name_sanitized %>(
    common_data_t *common_data,
    <%= e.args.map{ |s| "#{s.type} #{s.name}" }.join(", ") %>) {

  <%= e.name_sanitized %>_static_callback_f *p =
      common_data->static_callbacks-><%= e.name_sanitized %>;
  if (p)
    p(((void *)common_data), <%= e.args.map{ |s| s.name }.join(", ") %>);
}
<% end %>
